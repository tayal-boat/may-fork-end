<div class="shop_by_category_section container cf section-id-{{ section.id }} top-collections top-2 px-lg-0" data-section-type="custom-row">
    {%- if section.settings.view_Url != blank or section.settings.title != blank -%}
        <header class="section__header text-container d-flex justify-content-between px-lg-5 mb-0 mb-lg-3 pb-4">
            {%- if section.settings.title != blank -%}
                <h3 class="heading h2">{{ section.settings.title | escape }}</h3>
            {%- endif -%}
            {%- comment -%}
                {%- if section.settings.view_Url != blank -%}
                    <a class="text-red d-lg-none mr-3" href="{{ section.settings.view_Url }}"><u><b>VIEW ALL</b></u></a>
                {%- endif -%}
            {%- endcomment -%}
        </header>
    {%- endif -%}
    <div class="shop_by_collection-row mx-lg-5 ">
        <div class="row owl-carousel owl-theme shop-by-category-slider {{ section.id }} ">
            {% for block in section.blocks %}
                <div class="">
                    <a href="{{ block.settings.imageUrl }}" class="collection-block">
                        <div class="collection collection-{{ forloop.index }}" data-item="{{ block.settings.collection_Title }}">
                            <span class="collection-image">
                                <img loading="eager" src="{{block.settings.image | img_url: '150x'}}" alt="{{ block.settings.collection_Title }}">
                            </span>
                        </div>
                        <span class="collection-text text-center text-white">
                            <span class="collection-title text-center">{{ block.settings.collection_Title }}</span>
                        </span>
                    </a>
              </div>
            {% endfor %}
        </div>
    </div>
</div>

<script>
  $('.top-collections.top-2 .collection').each(function () {
      $(this).click(function () {
          let item = $(this).data('item');
          clevertap.event.push('Top Collections Clicked', {
              "Item": item
          });
      });
  });
</script>

<script>
    $(document).ready(function() {
      var $owl = $('#shopify-section-{{ section.id }}.owl-carousel');
        $owl.on('initialized.owl.carousel', function(event) {
            $('.temp-slide').remove();
        });

        $('.shop-by-category-slider.{{ section.id }}').owlCarousel({
            loop: false,
            responsiveClass: true,
            autoplay: false,
            items: 5,
            slideBy: 3,
            nav: false,
            dots: true,
            merge: true,
            dragBeforeAnimFinish: false,
            responsive: {
                300: {
                    items: {{section.settings.slides_no}},
                    loop: false
                },
                800: {
                    items: 5,
                    loop: false,
                    mergeFit: true
                },
                1000: {
                    items: {{ section.settings.deskslides_no}},
                    loop: false
                }
            }
        }).on("dragged.owl.carousel", function(event) {
            slide_item_on_drag( '.shop-by-category-slider.{{ section.id }}', event.relatedTarget['_drag']['direction'] );
        });

        function slide_item_on_drag(section_id, drag_direction) {
            if( drag_direction == 'left' ){
                //$(section_id + ' .owl-dots .owl-dot.active').next().click();
                $(section_id + ' .owl-dots .owl-dot.active').next().click();
            }else{
                //$(section_id + ' .owl-dots .owl-dot.active').prev().click();
                //$(section_id + ' .owl-dots .owl-dot.active').prev().click();
            }
        }
    })
</script>

{% schema %}
{
  "name": "Shop by category",
  "settings": [
      {
          "type": "text",
          "id": "title",
          "label": "Heading",
          "default": "Your title"
      },
      {
          "type": "url",
          "id": "view_Url",
          "label": "viewall URL"
      },
      {
          "type": "number",
          "id": "slides_no",
          "label": "mobile slides",
          "default": 1
      },
      {
          "type": "number",
          "id": "deskslides_no",
          "label": "desk slides",
          "default": 3
      }
  ],
  "blocks": [
      {
          "type": "image",
          "name": "Slide",
          "settings": [
              {
                  "type": "image_picker",
                  "id": "image",
                  "label": "Primary image",
                  "info": "300px wide minimum"
              },
              {
                  "type": "url",
                  "id": "imageUrl",
                  "label": "imageUrl"
              },
              {
                  "type": "text",
                  "id": "collection_Title",
                  "label": "Collection Title"
              }
          ]
      }
  ],
  "presets": [
      {
          "name": "Shop by category",
          "category": "Image",
          "settings": {},
          "blocks": [
              {
                  "type": "image"
              }
          ]
      }
  ]
}
{% endschema %}
