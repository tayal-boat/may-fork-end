var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function r(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function s(t){t.parentNode.removeChild(t)}let a;function c(t){a=t}const l=[],u=[],d=[],p=[],f=Promise.resolve();let g=!1;function m(t){d.push(t)}const h=new Set;let k=0;function w(){const t=a;do{for(;k<l.length;){const t=l[k];k++,c(t),y(t.$$)}for(c(null),l.length=0,k=0;u.length;)u.pop()();for(let t=0;t<d.length;t+=1){const e=d[t];h.has(e)||(h.add(e),e())}d.length=0}while(l.length);for(;p.length;)p.pop()();g=!1,h.clear(),c(t)}function y(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(m)}}const $=new Set;function v(t,e){-1===t.$$.dirty[0]&&(l.push(t),g||(g=!0,f.then(w)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function b(i,l,u,d,p,f,g,h=[-1]){const k=a;c(i);const y=i.$$={fragment:null,ctx:null,props:f,update:t,not_equal:p,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(l.context||(k?k.$$.context:[])),callbacks:n(),dirty:h,skip_bound:!1,root:l.target||k.$$.root};g&&g(y.root);let b=!1;if(y.ctx=u?u(i,l.props||{},((t,e,...n)=>{const o=n.length?n[0]:e;return y.ctx&&p(y.ctx[t],y.ctx[t]=o)&&(!y.skip_bound&&y.bound[t]&&y.bound[t](o),b&&v(i,t)),e})):[],y.update(),b=!0,o(y.before_update),y.fragment=!!d&&d(y.ctx),l.target){if(l.hydrate){const t=(C=l.target,Array.from(C.childNodes));y.fragment&&y.fragment.l(t),t.forEach(s)}else y.fragment&&y.fragment.c();l.intro&&((S=i.$$.fragment)&&S.i&&($.delete(S),S.i(_))),function(t,n,i,s){const{fragment:a,on_mount:c,on_destroy:l,after_update:u}=t.$$;a&&a.m(n,i),s||m((()=>{const n=c.map(e).filter(r);l?l.push(...n):o(n),t.$$.on_mount=[]})),u.forEach(m)}(i,l.target,l.anchor,l.customElement),w()}var S,_,C;c(k)}function S(t,e){document.dispatchEvent(function(t,e,{bubbles:n=!1,cancelable:o=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,o,e),r}(t,Object.assign({version:"3.49.0"},e),{bubbles:!0}))}function _(e){const n={c:t,l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:t,p:t,i:t,o:t,d:t};return S("SvelteRegisterBlock",{block:n,id:_.name,type:"component",source:"",ctx:e}),n}function C(t,e,n,o){var r=new XMLHttpRequest;r.open(t,e,!0),r.setRequestHeader("Content-type","application/json"),r.onload=function(){var t=r.status,e=r.response;o(t,e)},r.send(n?JSON.stringify(n):null)}function x(){var t=JSON.parse(localStorage.getItem("cartItems"));if(t&&t.length){var e={items:t};localStorage.removeItem("gkbuynow"),C("POST","/cart/clear.js","",(function(t){200===t&&C("POST","/cart/add.js",e,(function(t){200==t&&localStorage.removeItem("cartItems")}))}))}else"active"===localStorage.getItem("gkbuynow")&&C("POST","/cart/clear.js","",(()=>{localStorage.removeItem("gkbuynow")}))}function I(t){let e=t+"=",n=document.cookie.split(";");for(let t=0;t<n.length;t++){let o=n[t];for(;" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(e))return o.substring(e.length,o.length)}return""}function j(t){return"local"===t?"http://localhost:8080/integration.js":"dev"===t||"hdev"===t||"ndev"===t?"https://dev.pdp.gokwik.co/integration.js":"production"===t||"pci-prod"===t?"https://pdp.gokwik.co/integration.js":"sandbox"===t?"https://sandbox.pdp.gokwik.co/integration.js":"qatwo"===t?"https://qatwo.pdp.gokwik.co/integration.js":"qa"===t&&"https://qa.pdp.gokwik.co/integration.js"}function O(t){const e=j(t);var n=document.createElement("script");n.setAttribute("src",e),n.id="gokwikIntegration",document.head.appendChild(n)}function q(t,e){return new Promise((function(n,o){var r=new XMLHttpRequest;r.open("POST",t),r.setRequestHeader("Content-Type","application/json"),r.onload=function(){const t=JSON.parse(r.response);n(t)},r.onerror=function(){const t=JSON.parse(r.response);n(t)},r.send(JSON.stringify(e))}))}function E(t,e=window.location.href){t=t.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}function N(t,e,n){var o="";if(n){var r=new Date;r.setTime(r.getTime()+24*n*60*60*1e3),o="; expires="+r.toUTCString()}document.cookie=t+"="+(e||"")+o+"; path=/"}function T(t,e,n){let{$$slots:o={},$$scope:r}=e;var i,s,a,c;function l(t=!1){if(s.items.length){merchantInfo.checkoutType="headless";var e=JSON.stringify(s)}else e=document.querySelector(productFormSelector).serialize();t&&(e=document.querySelector(t).serialize()),C("POST","/cart/add.js",JSON.parse(e),(function(t){200==t&&(gokwikSdk.initCheckout(merchantInfo),c=cart.items,localStorage.setItem("gkbuynow","active"))}))}function u(t=!1){C("GET","/cart.js","",(function(e,n){var o=JSON.parse(n);if(200===e&&o.item_count){var r=o.items.map((t=>({id:t.id,quantity:t.quantity,options_with_values:t.options_with_values})));localStorage.setItem("cartItems",JSON.stringify(r)),C("POST","/cart/clear.js","",(function(e){200===e&&l(t)}))}else l(t)}))}!function(t,e,n){for(const o of Object.keys(e))~n.indexOf(o)||console.warn(`<${t}> received an unexpected slot "${o}".`)}("App",o,[]),window.onload=()=>{if(s={items:[]},i=E("pid")?.split(" "),a=E("cp"),i)for(const t of i)s.items.push({id:t,quantity:1});s.items.length&&(a?N("discount_code",a):N("discount_code","",-1),u())},O(merchantInfo.environment),x(),HTMLElement.prototype.serialize=function(){for(var t={},e=this.querySelectorAll("input, select, textarea"),n=0;n<e.length;++n){var o=e[n],r=o.name,i=o.value;r&&(t[r]=i)}return JSON.stringify(t)};const d=t=>"production"===t?"https://hits.gokwik.co/api/v1/events":"qa"===t?"https://qa-hits.gokwik.co/api/v1/events":"https://sandbox-hits.gokwik.co/api/v1/events";function p(t,e){var n=d(merchantInfo.environment),o=Date.now(),r=navigator.userAgent,i=window.merchantInfo.mid,s=t,a=e,c=I("_shopify_sa_p"),l=localStorage.getItem("gokwik-sessionID"),u={timestamp:o,userAgent:r,version:"1",merchantId:i,name:s,sessionId:l,type:"event",adSource:c,eventType:a};l||delete u.sessionId,c||delete u.adSource,q(n,u)}function f(){gokwikSdk.initCheckout(merchantInfo),p("gokwik-button-clicked","onGkClick")}window.onCheckoutClick=t=>{const e=t.lastElementChild;e.setAttribute("id","btn-loader"),t.disabled=!0,t.style.cursor="not-allowed",f(),e.style.display="flex",setTimeout((()=>{e.style.display="none",t.disabled=!1,t.style.cursor="pointer",e.removeAttribute("id")}),3e3)},window.onBuyNowClick=(t,e=!1)=>{p("gk_buy_now_button_clicked","onGkClick");const n=t.children[0];n.setAttribute("id","btn-loader"),t.disabled=!0,t.style.cursor="not-allowed",u(e),n.style.display="flex",setTimeout((()=>{n.style.display="none",t.disabled=!1,t.style.cursor="pointer",n.removeAttribute("id")}),3e3)},setTimeout((()=>{gokwikSdk&&gokwikSdk.on("modal_closed",(()=>{x()}))}),3e3),window.onNativeCheckoutClick=()=>{p("ShopifyCheckoutClicked","onGkClick")};const g=[];return Object.keys(e).forEach((t=>{~g.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<App> was created with unknown prop '${t}'`)})),t.$capture_state=()=>({pageProducts:i,pageItem:s,pageCoupon:a,productUrl:c,makeXhr:C,addCartBuyNow:l,gokwikBuyNow:u,retrieveCart:x,getCookie:I,getAnalyticsPath:d,getIntegrationPath:j,createIntegrationScript:O,logEvent:p,xhrPostCall:q,initiateGokwik:f,getParameterByName:E,setCookie:N}),t.$inject_state=t=>{"pageProducts"in t&&(i=t.pageProducts),"pageItem"in t&&(s=t.pageItem),"pageCoupon"in t&&(a=t.pageCoupon),"productUrl"in t&&(c=t.productUrl)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[]}return new class extends class extends class{$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){if(!t||!t.target&&!t.$$inline)throw new Error("'target' is a required option");super()}$destroy(){super.$destroy(),this.$destroy=()=>{console.warn("Component was already destroyed")}}$capture_state(){}$inject_state(){}}{constructor(t){super(t),b(this,t,T,_,i,{}),S("SvelteRegisterComponent",{component:this,tagName:"App",options:t,id:_.name})}}({target:window.parent,props:{name:"world"}})}();
