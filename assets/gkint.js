var app=function(){"use strict";function t(){}function e(t){return t()}function o(){return Object.create(null)}function n(t){t.forEach(e)}function r(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function s(t){t.parentNode.removeChild(t)}let c;function a(t){c=t}const l=[],u=[],d=[],p=[],g=Promise.resolve();let f=!1;function m(t){d.push(t)}const h=new Set;let k=0;function w(){const t=c;do{for(;k<l.length;){const t=l[k];k++,a(t),y(t.$$)}for(a(null),l.length=0,k=0;u.length;)u.pop()();for(let t=0;t<d.length;t+=1){const e=d[t];h.has(e)||(h.add(e),e())}d.length=0}while(l.length);for(;p.length;)p.pop()();f=!1,h.clear(),a(t)}function y(t){if(null!==t.fragment){t.update(),n(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(m)}}const $=new Set;const v="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function b(t,e){-1===t.$$.dirty[0]&&(l.push(t),f||(f=!0,g.then(w)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function S(i,l,u,d,p,g,f,h=[-1]){const k=c;a(i);const y=i.$$={fragment:null,ctx:null,props:g,update:t,not_equal:p,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(l.context||(k?k.$$.context:[])),callbacks:o(),dirty:h,skip_bound:!1,root:l.target||k.$$.root};f&&f(y.root);let v=!1;if(y.ctx=u?u(i,l.props||{},((t,e,...o)=>{const n=o.length?o[0]:e;return y.ctx&&p(y.ctx[t],y.ctx[t]=n)&&(!y.skip_bound&&y.bound[t]&&y.bound[t](n),v&&b(i,t)),e})):[],y.update(),v=!0,n(y.before_update),y.fragment=!!d&&d(y.ctx),l.target){if(l.hydrate){const t=(C=l.target,Array.from(C.childNodes));y.fragment&&y.fragment.l(t),t.forEach(s)}else y.fragment&&y.fragment.c();l.intro&&((S=i.$$.fragment)&&S.i&&($.delete(S),S.i(_))),function(t,o,i,s){const{fragment:c,on_mount:a,on_destroy:l,after_update:u}=t.$$;c&&c.m(o,i),s||m((()=>{const o=a.map(e).filter(r);l?l.push(...o):n(o),t.$$.on_mount=[]})),u.forEach(m)}(i,l.target,l.anchor,l.customElement),w()}var S,_,C;a(k)}function _(t,e){document.dispatchEvent(function(t,e,{bubbles:o=!1,cancelable:n=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,o,n,e),r}(t,Object.assign({version:"3.49.0"},e),{bubbles:!0}))}const{console:C}=v;function x(e){const o={c:t,l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:t,p:t,i:t,o:t,d:t};return _("SvelteRegisterBlock",{block:o,id:x.name,type:"component",source:"",ctx:e}),o}function I(t,e,o,n){var r=new XMLHttpRequest;r.open(t,e,!0),r.setRequestHeader("Content-type","application/json"),r.onload=function(){var t=r.status,e=r.response;n(t,e)},r.send(o?JSON.stringify(o):null)}function O(){var t=JSON.parse(localStorage.getItem("cartItems"));if(t&&t.length){var e={items:t};localStorage.removeItem("gkbuynow"),I("POST","/cart/clear.js","",(function(t){200===t&&I("POST","/cart/add.js",e,(function(t){200==t&&localStorage.removeItem("cartItems")}))}))}else"active"===localStorage.getItem("gkbuynow")&&I("POST","/cart/clear.js","",(()=>{localStorage.removeItem("gkbuynow")}))}function j(t){let e=t+"=",o=document.cookie.split(";");for(let t=0;t<o.length;t++){let n=o[t];for(;" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(e))return n.substring(e.length,n.length)}return""}function N(t){return"local"===t?"http://localhost:8080/integration.js":"dev"===t||"hdev"===t||"ndev"===t?"https://dev.pdp.gokwik.co/integration.js":"production"===t||"pci-prod"===t?"https://pdp.gokwik.co/integration.js":"sandbox"===t?"https://sandbox.pdp.gokwik.co/integration.js":"qatwo"===t?"https://qatwo.pdp.gokwik.co/integration.js":"qa"===t&&"https://qa.pdp.gokwik.co/integration.js"}function E(t){const e=N(t);var o=document.createElement("script");o.setAttribute("src",e),o.id="gokwikIntegration",document.head.appendChild(o)}function T(t,e){return new Promise((function(o,n){var r=new XMLHttpRequest;r.open("POST",t),r.setRequestHeader("Content-Type","application/json"),r.onload=function(){const t=JSON.parse(r.response);o(t)},r.onerror=function(){const t=JSON.parse(r.response);o(t)},r.send(JSON.stringify(e))}))}function q(t,e=window.location.href){t=t.replace(/[\[\]]/g,"\\$&");var o=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);return o?o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):"":null}function P(t,e,o){var n="";if(o){var r=new Date;r.setTime(r.getTime()+24*o*60*60*1e3),n="; expires="+r.toUTCString()}document.cookie=t+"="+(e||"")+n+"; path=/"}function A(t,e,o){let{$$slots:n={},$$scope:r}=e;var i,s,c,a;function l(t=!1){var e;console.log("addCartBuyNow called"),s&&s.items.length?(merchantInfo.checkoutType="headless",e=JSON.stringify(s)):e=t?document.querySelector(t).serialize():document.querySelector(productFormSelector).serialize(),I("POST","/cart/add.js",JSON.parse(e),(function(t){200==t&&(console.log("gokwikSdk.initCheckout called"),gokwikSdk.initCheckout(merchantInfo),a=cart.items,localStorage.setItem("gkbuynow","active"))}))}function u(t=!1){console.log("gokwikBuyNow called"),I("GET","/cart.js","",(function(e,o){var n=JSON.parse(o);if(200===e&&n.item_count){var r=n.items.map((t=>({id:t.id,quantity:t.quantity,options_with_values:t.options_with_values})));localStorage.setItem("cartItems",JSON.stringify(r)),I("POST","/cart/clear.js","",(function(e){200===e&&l(t)}))}else l(t)}))}!function(t,e,o){for(const n of Object.keys(e))~o.indexOf(n)||console.warn(`<${t}> received an unexpected slot "${n}".`)}("App",n,[]),console.log("gokwik started..."),addEventListener("DOMContentLoaded",(()=>{if(console.log("window.onload called"),s={items:[]},i=q("pid")?.split(" "),c=q("cp"),i){console.log("pageProducts");for(const t of i)s.items.push({id:t,quantity:1})}s.items.length&&(c?P("discount_code",c):P("discount_code","",-1),u())})),E(merchantInfo.environment),O(),HTMLElement.prototype.serialize=function(){for(var t={},e=this.querySelectorAll("input, select, textarea"),o=0;o<e.length;++o){var n=e[o],r=n.name,i=n.value;r&&(t[r]=i)}return JSON.stringify(t)};const d=t=>"production"===t?"https://hits.gokwik.co/api/v1/events":"qa"===t?"https://qa-hits.gokwik.co/api/v1/events":"https://sandbox-hits.gokwik.co/api/v1/events";function p(t,e){var o=d(merchantInfo.environment),n=Date.now(),r=navigator.userAgent,i=window.merchantInfo.mid,s=t,c=e,a=j("_shopify_sa_p"),l=localStorage.getItem("gokwik-sessionID"),u={timestamp:n,userAgent:r,version:"1",merchantId:i,name:s,sessionId:l,type:"event",adSource:a,eventType:c};l||delete u.sessionId,a||delete u.adSource,T(o,u)}function g(){gokwikSdk.initCheckout(merchantInfo),p("gokwik-button-clicked","onGkClick")}window.onCheckoutClick=t=>{const e=t.lastElementChild;e.setAttribute("id","btn-loader"),t.disabled=!0,t.style.cursor="not-allowed",g(),e.style.display="flex",setTimeout((()=>{e.style.display="none",t.disabled=!1,t.style.cursor="pointer",e.removeAttribute("id")}),3e3)},window.onBuyNowClick=(t,e=!1)=>{p("gk_buy_now_button_clicked","onGkClick");const o=t.children[0];o.setAttribute("id","btn-loader"),t.disabled=!0,t.style.cursor="not-allowed",u(e),o.style.display="flex",setTimeout((()=>{o.style.display="none",t.disabled=!1,t.style.cursor="pointer",o.removeAttribute("id")}),3e3)},setTimeout((()=>{gokwikSdk&&gokwikSdk.on("modal_closed",(()=>{O()}))}),3e3),window.onNativeCheckoutClick=()=>{p("ShopifyCheckoutClicked","onGkClick")};const f=[];return Object.keys(e).forEach((t=>{~f.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||C.warn(`<App> was created with unknown prop '${t}'`)})),t.$capture_state=()=>({pageProducts:i,pageItem:s,pageCoupon:c,productUrl:a,makeXhr:I,addCartBuyNow:l,gokwikBuyNow:u,retrieveCart:O,getCookie:j,getAnalyticsPath:d,getIntegrationPath:N,createIntegrationScript:E,logEvent:p,xhrPostCall:T,initiateGokwik:g,getParameterByName:q,setCookie:P}),t.$inject_state=t=>{"pageProducts"in t&&(i=t.pageProducts),"pageItem"in t&&(s=t.pageItem),"pageCoupon"in t&&(c=t.pageCoupon),"productUrl"in t&&(a=t.productUrl)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[]}return new class extends class extends class{$destroy(){!function(t,e){const o=t.$$;null!==o.fragment&&(n(o.on_destroy),o.fragment&&o.fragment.d(e),o.on_destroy=o.fragment=null,o.ctx=[])}(this,1),this.$destroy=t}$on(t,e){const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(e),()=>{const t=o.indexOf(e);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){if(!t||!t.target&&!t.$$inline)throw new Error("'target' is a required option");super()}$destroy(){super.$destroy(),this.$destroy=()=>{console.warn("Component was already destroyed")}}$capture_state(){}$inject_state(){}}{constructor(t){super(t),S(this,t,A,x,i,{}),_("SvelteRegisterComponent",{component:this,tagName:"App",options:t,id:x.name})}}({target:window.parent,props:{name:"world"}})}();
